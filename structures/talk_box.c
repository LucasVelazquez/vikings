#include "talk_box.h"
#include "../utils/utils.h"

char talk_box[MAX_ROWS_TALK_BOX][MAX_COLUMNS_TALK_BOX] = 
{
	{201,205,205,205,205,205,205,205,205,205,205,205,205,205,205,205,205,205,205,205,205,205,205,205,205,205,205,205,205,205,205,205,205,205,205,205,205,205,205,205,205,205,205,205,205,202,205,205,205,205,205,205,205,205,205,205,205,205,205,205,205,205,205,185},
	{186,' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',186},
	{186,' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',186},
	{186,' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',186},
	{186,' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',186},
	{186,' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',186},
	{186,' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',186},
	{186,' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',186},
	{200,205,205,205,205,205,205,205,205,205,205,205,205,205,205,205,205,205,205,205,205,205,205,205,205,205,205,205,205,205,205,205,205,205,205,205,205,205,205,205,205,205,205,205,205,205,205,205,205,205,205,205,205,205,205,205,205,205,205,205,205,205,205,188}
};

int talk_box_map_draw_x =3;
int talk_box_map_draw_y =17;

void drawTalkBox()
{
	int aux_talk_box_map_draw_x = talk_box_map_draw_x;
	int aux_talk_box_map_draw_y = talk_box_map_draw_y;

	gotoxy(aux_talk_box_map_draw_x, aux_talk_box_map_draw_y);
	int initial_value_draw_x = aux_talk_box_map_draw_x;

	for(int i = 0; i < MAX_ROWS_TALK_BOX; ++i)
	{
		++aux_talk_box_map_draw_y;
		for(int j = 0; j < MAX_COLUMNS_TALK_BOX; ++j)
		{
			++aux_talk_box_map_draw_x;
			gotoxy(aux_talk_box_map_draw_x, aux_talk_box_map_draw_y);
			printf("%c", talk_box[i][j]);
		}
		aux_talk_box_map_draw_x = initial_value_draw_x;
	}
}

//66 letras por linea
//7 lineas maximo

void showText(char text[])
{
	drawTalkBox();

	int count_line = 1;
	
	int init_text_position = talk_box_map_draw_x + 3;

	int text_place_x = init_text_position;
	int text_place_y = talk_box_map_draw_y + 2;

	gotoxy(text_place_x, text_place_y);

	for(int i = 0; i < strlen(text); ++i)
	{
		if(text_place_x % 65 == 1)
		{
			text_place_x = init_text_position;
			if(count_line == 7)
			{
				int key_pressed;
				gotoxy(65, 25);
				do
				{
					key_pressed = getch();

				}while(key_pressed != 105);

				drawTalkBox();
				count_line = 1;
				text_place_y = talk_box_map_draw_y + 2;
			}
			else
			{
				++count_line;
				++text_place_y;
			}
			
			gotoxy(init_text_position, text_place_y);
		}

		putchar(text[i]);
		++text_place_x;
	}

	int key_pressed;
	do
	{
		key_pressed = getch();

	}while(key_pressed != 105);
	drawTalkBox();
}
